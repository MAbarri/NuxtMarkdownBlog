import{bD as e,bG as t}from"../runtime.mjs";import{u as r}from"./asyncData-OK3DIDI3.mjs";import{q as u}from"./query-BuxgHUnZ.mjs";import{g as n}from"./server.mjs";import{u as o,d as l,f as a,a as i,O as s,h as d}from"../routes/renderer.mjs";import"./preview-wkaBPEZ5.mjs";const p=l({name:"ContentQuery",props:{path:{type:String,required:!1,default:void 0},only:{type:Array,required:!1,default:void 0},without:{type:Array,required:!1,default:void 0},where:{type:Object,required:!1,default:void 0},sort:{type:Object,required:!1,default:void 0},limit:{type:Number,required:!1,default:void 0},skip:{type:Number,required:!1,default:void 0},locale:{type:String,required:!1,default:void 0},find:{type:String,required:!1,default:void 0}},async setup(o){const{path:l,only:s,without:d,where:p,sort:v,limit:f,skip:h,locale:m,find:y}=e(o),c=a((()=>{var e;return null==(e=l.value)?void 0:e.includes("/_")})),w=!n().public.content.experimental.advanceQuery;i((()=>o),(()=>g()),{deep:!0});const resolveResult=e=>w?(null==e?void 0:e.surround)?e.surround:(null==e?void 0:e._id)||Array.isArray(e)?e:null==e?void 0:e.result:e.result,{data:q,refresh:g}=await r(`content-query-${t(o)}`,(()=>{let e;return e=l.value?u(l.value):u(),s.value&&(e=e.only(s.value)),d.value&&(e=e.without(d.value)),p.value&&(e=e.where(p.value)),v.value&&(e=e.sort(v.value)),f.value&&(e=e.limit(f.value)),h.value&&(e=e.skip(h.value)),m.value&&(e=e.where({_locale:m.value})),"one"===y.value?e.findOne().then(resolveResult):"surround"===y.value?l.value?w?e.findSurround(l.value):e.withSurround(l.value).findOne().then(resolveResult):(console.warn("[Content] Surround queries requires `path` prop to be set."),console.warn("[Content] Query without `path` will return regular `find()` results."),e.find().then(resolveResult)):e.find().then(resolveResult)}));return{isPartial:c,data:q,refresh:g}},render(e){var t;const r=s(),{data:u,refresh:n,isPartial:o,path:l,only:a,without:i,where:p,sort:v,limit:f,skip:h,locale:m,find:y}=e,c={path:l,only:a,without:i,where:p,sort:v,limit:f,skip:h,locale:m,find:y};if("one"===c.find){if(!u&&(null==r?void 0:r["not-found"]))return r["not-found"]({props:c,...this.$attrs});if((null==r?void 0:r.empty)&&"markdown"===(null==u?void 0:u._type)&&!(null==(t=null==u?void 0:u.body)?void 0:t.children.length))return r.empty({props:c,...this.$attrs})}else if((!u||!u.length)&&(null==r?void 0:r["not-found"]))return r["not-found"]({props:c,...this.$attrs});if(null==r?void 0:r.default)return r.default({data:u,refresh:n,isPartial:o,props:c,...this.$attrs});return w="default",q={data:u,props:c,isPartial:o},d("pre",null,JSON.stringify({message:"You should use slots with <ContentQuery>!",slot:w,data:q},null,2));var w,q}}),v=p.setup;p.setup=(e,t)=>{const r=o();return(r.modules||(r.modules=new Set)).add("node_modules/@nuxt/content/dist/runtime/components/ContentQuery.vue"),v?v(e,t):void 0};export{p as default};
//# sourceMappingURL=ContentQuery-Bvdw7yYo.mjs.map
